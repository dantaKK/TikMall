import{m as Z,n as L,p as B,q as de,s as H,x as J,a as p,e as o,y as C,I as q,z as ee,A as Re,B as Ae,C as _e,D as Be,E as De,G as Ne,H as Oe,r as U,J as $e,K as A,L as re,M as ze,N as qe,O as Fe,P as K,Q as We,R as je,S as ce,T as Ke,U as He,V as Y,W as X,g as Ue,X as Ye,Y as oe}from"./index-D4Vk8HQL.js";import{r as Je,u as Ge,F as Qe}from"./index-EDWo_QzD.js";import{u as fe,a as ge}from"./use-id-nfm9DGiW.js";const[Xe,_]=Z("cell"),me={tag:L("div"),icon:String,size:String,title:B,value:B,label:B,center:Boolean,isLink:Boolean,border:de,iconPrefix:String,valueClass:H,labelClass:H,titleClass:H,titleStyle:null,arrowDirection:String,required:{type:[Boolean,String],default:null},clickable:{type:Boolean,default:null}},Ze=J({},me,Je);var pe=p({name:Xe,props:Ze,setup(e,{slots:t}){const l=Ge(),g=()=>{if(t.label||C(e.label))return o("div",{class:[_("label"),e.labelClass]},[t.label?t.label():e.label])},r=()=>{var s;if(t.title||C(e.title)){const b=(s=t.title)==null?void 0:s.call(t);return Array.isArray(b)&&b.length===0?void 0:o("div",{class:[_("title"),e.titleClass],style:e.titleStyle},[b||o("span",null,[e.title]),g()])}},u=()=>{const s=t.value||t.default;if(s||C(e.value))return o("div",{class:[_("value"),e.valueClass]},[s?s():o("span",null,[e.value])])},T=()=>{if(t.icon)return t.icon();if(e.icon)return o(q,{name:e.icon,class:_("left-icon"),classPrefix:e.iconPrefix},null)},S=()=>{if(t["right-icon"])return t["right-icon"]();if(e.isLink){const s=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return o(q,{name:s,class:_("right-icon")},null)}};return()=>{var s;const{tag:b,size:d,center:D,border:M,isLink:N,required:O}=e,v=(s=e.clickable)!=null?s:N,x={center:D,required:!!O,clickable:v,borderless:!M};return d&&(x[d]=!!d),o(b,{class:_(x),role:v?"button":void 0,tabindex:v?0:void 0,onClick:l},{default:()=>{var w;return[T(),r(),u(),S(),(w=t.extra)==null?void 0:w.call(t)]}})}}});const en=ee(pe);function be(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function nn(e,t){if(be(e)){if(t.required)return!1;if(t.validateEmpty===!1)return!0}return!(t.pattern&&!t.pattern.test(String(e)))}function tn(e,t){return new Promise(l=>{const g=t.validator(e,t);if(_e(g)){g.then(l);return}l(g)})}function se(e,t){const{message:l}=t;return Be(l)?l(e,t):l||""}function an({target:e}){e.composing=!0}function ue({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function ln(e,t){const l=Re();e.style.height="auto";let g=e.scrollHeight;if(De(t)){const{maxHeight:r,minHeight:u}=t;r!==void 0&&(g=Math.min(g,r)),u!==void 0&&(g=Math.max(g,u))}g&&(e.style.height=`${g}px`,Ae(l))}function rn(e,t){return e==="number"&&(e="text",t??(t="decimal")),e==="digit"&&(e="tel",t??(t="numeric")),{type:e,inputmode:t}}function I(e){return[...e].length}function Q(e,t){return[...e].slice(0,t).join("")}const[cn,h]=Z("field"),ne={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:B,max:Number,min:Number,formatter:Function,clearIcon:L("clear"),modelValue:Ne(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:L("focus"),formatTrigger:L("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null},inputmode:String},on=J({},me,ne,{rows:B,type:L("text"),rules:Array,autosize:[Boolean,Object],labelWidth:B,labelClass:H,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var sn=p({name:cn,props:on,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:t,slots:l}){const g=fe(),r=Oe({status:"unvalidated",focused:!1,validateMessage:""}),u=U(),T=U(),S=U(),{parent:s}=$e(Qe),b=()=>{var n;return String((n=e.modelValue)!=null?n:"")},d=n=>{if(C(e[n]))return e[n];if(s&&C(s.props[n]))return s.props[n]},D=A(()=>{const n=d("readonly");if(e.clearable&&!n){const a=b()!=="",i=e.clearTrigger==="always"||e.clearTrigger==="focus"&&r.focused;return a&&i}return!1}),M=A(()=>S.value&&l.input?S.value():e.modelValue),N=A(()=>{var n;const a=d("required");return a==="auto"?(n=e.rules)==null?void 0:n.some(i=>i.required):a}),O=n=>n.reduce((a,i)=>a.then(()=>{if(r.status==="failed")return;let{value:f}=M;if(i.formatter&&(f=i.formatter(f,i)),!nn(f,i)){r.status="failed",r.validateMessage=se(f,i);return}if(i.validator)return be(f)&&i.validateEmpty===!1?void 0:tn(f,i).then(m=>{m&&typeof m=="string"?(r.status="failed",r.validateMessage=m):m===!1&&(r.status="failed",r.validateMessage=se(f,i))})}),Promise.resolve()),v=()=>{r.status="unvalidated",r.validateMessage=""},x=()=>t("endValidate",{status:r.status,message:r.validateMessage}),w=(n=e.rules)=>new Promise(a=>{v(),n?(t("startValidate"),O(n).then(()=>{r.status==="failed"?(a({name:e.name,message:r.validateMessage}),x()):(r.status="passed",a(),x())})):a()}),$=n=>{if(s&&e.rules){const{validateTrigger:a}=s.props,i=ce(a).includes(n),f=e.rules.filter(m=>m.trigger?ce(m.trigger).includes(n):i);f.length&&w(f)}},G=n=>{var a;const{maxlength:i}=e;if(C(i)&&I(n)>+i){const f=b();if(f&&I(f)===+i)return f;const m=(a=u.value)==null?void 0:a.selectionEnd;if(r.focused&&m){const V=[...n],E=V.length-+i;return V.splice(m-E,E),V.join("")}return Q(n,+i)}return n},P=(n,a="onChange")=>{var i,f;const m=n;n=G(n);const V=I(m)-I(n);if(e.type==="number"||e.type==="digit"){const y=e.type==="number";n=Ke(n,y,y),a==="onBlur"&&n!==""&&(e.min!==void 0||e.max!==void 0)&&(n=He(+n,(i=e.min)!=null?i:-1/0,(f=e.max)!=null?f:1/0).toString())}let E=0;if(e.formatter&&a===e.formatTrigger){const{formatter:y,maxlength:k}=e;if(n=y(n),C(k)&&I(n)>+k&&(n=Q(n,+k)),u.value&&r.focused){const{selectionEnd:j}=u.value,ie=Q(m,j);E=I(y(ie))-I(ie)}}if(u.value&&u.value.value!==n)if(r.focused){let{selectionStart:y,selectionEnd:k}=u.value;if(u.value.value=n,C(y)&&C(k)){const j=I(n);V?(y-=V,k-=V):E&&(y+=E,k+=E),u.value.setSelectionRange(Math.min(y,j),Math.min(k,j))}}else u.value.value=n;n!==e.modelValue&&t("update:modelValue",n)},c=n=>{n.target.composing||P(n.target.value)},R=()=>{var n;return(n=u.value)==null?void 0:n.blur()},F=()=>{var n;return(n=u.value)==null?void 0:n.focus()},W=()=>{const n=u.value;e.type==="textarea"&&e.autosize&&n&&ln(n,e.autosize)},he=n=>{r.focused=!0,t("focus",n),K(W),d("readonly")&&R()},ve=n=>{r.focused=!1,P(b(),"onBlur"),t("blur",n),!d("readonly")&&($("onBlur"),K(W),Ye())},te=n=>t("clickInput",n),ye=n=>t("clickLeftIcon",n),ke=n=>t("clickRightIcon",n),Ie=n=>{Y(n),t("update:modelValue",""),t("clear",n)},ae=A(()=>{if(typeof e.error=="boolean")return e.error;if(s&&s.props.showError&&r.status==="failed")return!0}),Ce=A(()=>{const n=d("labelWidth"),a=d("labelAlign");if(n&&a!=="top")return{width:re(n)}}),Se=n=>{n.keyCode===13&&(!(s&&s.props.submitOnEnter)&&e.type!=="textarea"&&Y(n),e.type==="search"&&R()),t("keypress",n)},le=()=>e.id||`${g}-input`,xe=()=>r.status,we=()=>{const n=h("control",[d("inputAlign"),{error:ae.value,custom:!!l.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(l.input)return o("div",{class:n,onClick:te},[l.input()]);const a={id:le(),ref:u,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:n,disabled:d("disabled"),readonly:d("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${g}-label`:void 0,"data-allow-mismatch":"attribute",onBlur:ve,onFocus:he,onInput:c,onClick:te,onChange:ue,onKeypress:Se,onCompositionend:ue,onCompositionstart:an};return e.type==="textarea"?o("textarea",X(a,{inputmode:e.inputmode}),null):o("input",X(rn(e.type,e.inputmode),a),null)},Ve=()=>{const n=l["left-icon"];if(e.leftIcon||n)return o("div",{class:h("left-icon"),onClick:ye},[n?n():o(q,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},Ee=()=>{const n=l["right-icon"];if(e.rightIcon||n)return o("div",{class:h("right-icon"),onClick:ke},[n?n():o(q,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Le=()=>{if(e.showWordLimit&&e.maxlength){const n=I(b());return o("div",{class:h("word-limit")},[o("span",{class:h("word-num")},[n]),Ue("/"),e.maxlength])}},Te=()=>{if(s&&s.props.showErrorMessage===!1)return;const n=e.errorMessage||r.validateMessage;if(n){const a=l["error-message"],i=d("errorMessageAlign");return o("div",{class:h("error-message",i)},[a?a({message:n}):n])}},Me=()=>{const n=d("labelWidth"),a=d("labelAlign"),i=d("colon")?":":"";if(l.label)return[l.label(),i];if(e.label)return o("label",{id:`${g}-label`,for:l.input?void 0:le(),"data-allow-mismatch":"attribute",onClick:f=>{Y(f),F()},style:a==="top"&&n?{width:re(n)}:void 0},[e.label+i])},Pe=()=>[o("div",{class:h("body")},[we(),D.value&&o(q,{ref:T,name:e.clearIcon,class:h("clear")},null),Ee(),l.button&&o("div",{class:h("button")},[l.button()])]),Le(),Te()];return ge({blur:R,focus:F,validate:w,formValue:M,resetValidation:v,getValidationStatus:xe}),ze(qe,{customValue:S,resetValidation:v,validateWithTrigger:$}),Fe(()=>e.modelValue,()=>{P(b()),v(),$("onChange"),K(W)}),We(()=>{P(b(),e.formatTrigger),K(W)}),je("touchstart",Ie,{target:A(()=>{var n;return(n=T.value)==null?void 0:n.$el})}),()=>{const n=d("disabled"),a=d("labelAlign"),i=Ve(),f=()=>{const m=Me();return a==="top"?[i,m].filter(Boolean):m||[]};return o(en,{size:e.size,class:h({error:ae.value,disabled:n,[`label-${a}`]:a}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:Ce.value,valueClass:h("value"),titleClass:[h("label",[a,{required:N.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:i&&a!=="top"?()=>i:null,title:f,value:Pe,extra:l.extra})}}});const un=ee(sn),[dn,z,fn]=Z("search"),gn=J({},ne,{label:String,shape:L("square"),leftIcon:L("search"),clearable:de,actionText:String,background:String,showAction:Boolean});var mn=p({name:dn,props:gn,emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:t,slots:l,attrs:g}){const r=fe(),u=U(),T=()=>{l.action||(t("update:modelValue",""),t("cancel"))},S=c=>{c.keyCode===13&&(Y(c),t("search",e.modelValue))},s=()=>e.id||`${r}-input`,b=()=>{if(l.label||e.label)return o("label",{class:z("label"),for:s(),"data-allow-mismatch":"attribute"},[l.label?l.label():e.label])},d=()=>{if(e.showAction){const c=e.actionText||fn("cancel");return o("div",{class:z("action"),role:"button",tabindex:0,onClick:T},[l.action?l.action():c])}},D=()=>{var c;return(c=u.value)==null?void 0:c.blur()},M=()=>{var c;return(c=u.value)==null?void 0:c.focus()},N=c=>t("blur",c),O=c=>t("focus",c),v=c=>t("clear",c),x=c=>t("clickInput",c),w=c=>t("clickLeftIcon",c),$=c=>t("clickRightIcon",c),G=Object.keys(ne),P=()=>{const c=J({},g,oe(e,G),{id:s()}),R=F=>t("update:modelValue",F);return o(un,X({ref:u,type:"search",class:z("field",{"with-message":c.errorMessage}),border:!1,onBlur:N,onFocus:O,onClear:v,onKeypress:S,onClickInput:x,onClickLeftIcon:w,onClickRightIcon:$,"onUpdate:modelValue":R},c),oe(l,["left-icon","right-icon"]))};return ge({focus:M,blur:D}),()=>{var c;return o("div",{class:z({"show-action":e.showAction}),style:{background:e.background}},[(c=l.left)==null?void 0:c.call(l),o("div",{class:z("content",e.shape)},[b(),P()]),d()])}}});const yn=ee(mn);export{yn as S};
